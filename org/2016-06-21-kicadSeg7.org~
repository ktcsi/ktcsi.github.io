#+BEGIN_HTML
---
layout: post
title: FPGAボードで学ぶ組込みシステム開発入門[SX-Card3編]
published: true
category: IT
tag: [FPGA, Spartan-3, SX-Card3]
---
#+END_HTML
#+TITLE:
#+DATE: <2016-06-14 Tue>
#+AUTHOR: ktcsi
#+EMAIL: hoge@mail.com
#+OPTIONS: toc:nil num:nil
#+SELECT_TAGS: export
* FPGAボードで学ぶ組込みシステム開発入門[SX-Card3編]
#+begin_example
小林 優(2013).  FPGAボードで学ぶ組込みシステム開発入門[Xilinx編] 技術評論社
#+end_example
この書籍を参考に手元のボード(SX-Card3)を使って、FPGAに入門。
権利関係に気をつける。
** 1 FPGAボード
*** 1-1 FPGA
参考書の表1-1(Spartan-3E)に対応する表
#+CAPTION: FPGA(Spartan-3A DSP XC3SD1800A)のFPGA規模
| Device                 | XC3SD1800A                                |
| Package Type           | 676-ball Fine-Pitch Ball Grid Array(FBGA) |
| Speed Grade            | 4                                         |
| Temp Range             | Commercial(0℃ to 85℃)                     |
| System Gates           | 1800K                                     |
| Equivalent Logic Cells | 37,440                                    |
| Total CLBs             | 4,160                                     |
| Total Slices           | 16,640                                    |
| Block RAM Bits         | 1512K                                     |
| DSP48As                | 84                                        |
| DCMs                   | 8                                         | 
CLB = Configurable Logic Block, 
DCM = Digital Clock Manager, 
LUT = Look Up Table  
*** 1-2 使用するFPGAボード
参考書の表1-2に対応する表
#+CAPTION: 使用するFPGAボード(SX-Card3)
| メーカ         |         Prime Systems, Inc. |
| ボード名       |               SX-Card3/DSP4 |
| FPGA           |              Spartan-3A DSP |
| 外部メモリ     | 18Mbit同期SRAM（512K x 36b) |
| 単体LED        |                           8 |
| 汎用4bitDIP SW |                           1 |
| 汎用タクトSW   |                           1 |
| 高速ユーザIO   |                         200 |
| 汎用ユーザIO   |                        34x2 |
| GPIO           |                        8bit |
使用できるボードという理由ではじめたので、このボードでどこまで参考書を適用できるかは不明。
*** 1-3 コンフィギュレーション
**** USBコンフィギュレーション
USB経由によって複数のコンフィグデータを瞬時に書き換えられる。
SX-Card3ボードはリファレンスアプリケーション起動時に自動的にコンフィグする機能(オートコンフィグ機能)を持つ。
**** コンフィグROM
Spartan3A-DSP搭載ボードは、チップ外部のコンフィグ用ROMを用意。
Xilinx専用のダウンロードケーブルを利用して書き込む。
USBからコンフィグROMにプログラムすることはできない。
** 2 回路設計体験
*** 2-1 Xilinx ISE
Vivadoを使ってみたいんですけどね。
7シリーズFPGAを買ったら使える。
ISE WebPACKではFPGA内蔵CPUのMicroBlazeに制限があるようです。
- とりあえずISE14.7をインストール。
- WebPACK licenseを発行。
- メールでXilinx.licが届く
*** 2-2 回路設計とコンパイル
**** 7セグメント・デコーダの設計
7セグが付いていないので、8bitの単体LEDを代わりに使用して結果を確認する。
- seg7dec.vを作成し、ボード付属CDの制約ファイル(SX-Card3.ucf)を読み込む。
- Implement Designで使用していないピンのERRORが出るので、led, dipsw以外の記述をコメントアウト。
- ISEで.binファイルを生成する。Generate Programming Fileのオプション-g Binaryを指定。
- RefApp7の"USBコンフィグ"タブで.binファイルを指定して書き込む。
- ボード上のSW5を切り替えて結果を確認。
#+BEGIN_HTML
<script src="https://gist.github.com/ktcsi/3ba75a51bc7aa43d8cafe6de942387af.js"></script>
#+END_HTML
***** PranAhead, iMPACTを使用したコンフィグはJTAGケーブルが必要(?)。
***** コンフィグROMを使用するにはダウンロードケーブルが必要。→自作例あり。
** 3 進んだ回路設計
** 4 MicroBlaze MCS
** 5 MCSプログラミング
** 6 自作周辺回路
** 7 周辺回路設計
** 8 外部メモリとグラフィック表示回路
** 9 CMOSカメラ
